(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{283:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,AuthProvider:()=>s});var r=a(5155),l=a(2115),n=a(2099);let i=(0,l.createContext)(void 0),o=!n.ND||!0;function s(e){let{children:t}=e,[a,s]=(0,l.useState)(null),[u,d]=(0,l.useState)(null),[c,m]=(0,l.useState)(!0),g=()=>{{let e=localStorage.getItem("demo-user");if(console.log("Demo mode: checking localStorage for demo-user:",e),e)try{let t=JSON.parse(e);console.log("Demo mode: parsed user data:",t),s(t),d({id:t.id,email:t.email,public_name:t.email.split("@")[0],name:t.email.split("@")[0],role:"user",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}catch(e){console.error("Error parsing demo user data:",e)}else s(null),d(null)}};(0,l.useEffect)(()=>{if(o){g();let e=e=>{"demo-user"===e.key&&(console.log("Demo user localStorage changed, reloading user data"),g())};window.addEventListener("storage",e);let t=()=>{console.log("Demo user custom event triggered, reloading user data"),g()};return window.addEventListener("demo-user-updated",t),m(!1),()=>{window.removeEventListener("storage",e),window.removeEventListener("demo-user-updated",t)}}if(!n.ND)return void m(!1);(async()=>{var e;let{data:{session:t}}=await n.ND.auth.getSession();if(s(null!=(e=null==t?void 0:t.user)?e:null),null==t?void 0:t.user){let{data:e}=await (0,n.VM)(t.user.id);d(e)}m(!1)})();let{data:{subscription:e}}=n.ND.auth.onAuthStateChange(async(e,t)=>{var a;if(s(null!=(a=null==t?void 0:t.user)?a:null),null==t?void 0:t.user){let{data:e}=await (0,n.VM)(t.user.id);d(e)}else d(null);m(!1)});return()=>e.unsubscribe()},[]);let p=async()=>{if(o){localStorage.removeItem("demo-user"),s(null),d(null),window.dispatchEvent(new CustomEvent("demo-user-updated")),setTimeout(()=>{window.location.href="/"},100);return}if(!n.ND)return;let{error:e}=await n.ND.auth.signOut();e||(s(null),d(null))},w=async()=>{if(o&&a){let e=localStorage.getItem("demo-user");if(e)try{let t=JSON.parse(e);d({id:t.id,email:t.email,public_name:t.public_name||t.email.split("@")[0],name:t.name||t.email.split("@")[0],phone:t.phone||null,city:t.city||null,state:t.state||null,whatsapp:t.whatsapp||null,bio:t.bio||null,motivation:t.motivation||null,social_link:t.social_link||null,role:t.role||"user",created_at:t.created_at||new Date().toISOString(),updated_at:t.updated_at||new Date().toISOString()})}catch(e){console.error("Error refreshing demo profile:",e)}}else if(a){let{data:e}=await (0,n.VM)(a.id);d(e)}};return(0,r.jsx)(i.Provider,{value:{user:a,userProfile:u,loading:c,signOut:p,refreshProfile:w},children:t})}function u(){let e=(0,l.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},347:()=>{},2099:(e,t,a)=>{"use strict";a.d(t,{ND:()=>i,QH:()=>d,VM:()=>o,eg:()=>s,lh:()=>u});var r=a(5647);let l="https://xjkaqdsldskhlhjptrga.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhqa2FxZHNsc2RraGxoanB0cmdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwMTA3MDMsImV4cCI6MjA2ODU4NjcwM30.eJuf7qNjehg1eSg7GB3Tv7xSNdz6phbWKuC8Cci0kFM",i=l&&n&&1?(0,r.UU)(l,n):null,o=async e=>{if(!i)return{data:null,error:{message:"Supabase not configured"}};let{data:t,error:a}=await i.from("users").select("*").eq("id",e).single();return{data:t,error:a}},s=async(e,t)=>(await new Promise(e=>setTimeout(e,500)),{data:{id:e,...t,updated_at:new Date().toISOString()},error:null}),u=async e=>{if(!i)return{data:null,error:{message:"Supabase not configured"}};let{data:t,error:a}=await i.from("events").insert(e).select().single();return{data:t,error:a}},d=async()=>{if(!i)return{data:{total_raised:867,total_donors:23,currency:"BRL",last_updated:new Date().toISOString()},error:null};let{data:e,error:t}=await i.from("donation_stats").select("*").single();return{data:e,error:t}}},4286:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,347,23)),Promise.resolve().then(a.bind(a,283))}},e=>{e.O(0,[7690,5647,8441,5964,7358],()=>e(e.s=4286)),_N_E=e.O()}]);