"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2355],{283:(e,t,s)=>{s.d(t,{A:()=>d,AuthProvider:()=>o});var r=s(5155),a=s(2115),l=s(2099);let n=(0,a.createContext)(void 0),i=!l.ND||!0;function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),u=()=>{{let e=localStorage.getItem("demo-user");if(console.log("Demo mode: checking localStorage for demo-user:",e),e)try{let t=JSON.parse(e);console.log("Demo mode: parsed user data:",t),o(t),c({id:t.id,email:t.email,public_name:t.email.split("@")[0],name:t.email.split("@")[0],role:"user",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}catch(e){console.error("Error parsing demo user data:",e)}else o(null),c(null)}};(0,a.useEffect)(()=>{if(i){u();let e=e=>{"demo-user"===e.key&&(console.log("Demo user localStorage changed, reloading user data"),u())};window.addEventListener("storage",e);let t=()=>{console.log("Demo user custom event triggered, reloading user data"),u()};return window.addEventListener("demo-user-updated",t),x(!1),()=>{window.removeEventListener("storage",e),window.removeEventListener("demo-user-updated",t)}}if(!l.ND)return void x(!1);(async()=>{var e;let{data:{session:t}}=await l.ND.auth.getSession();if(o(null!=(e=null==t?void 0:t.user)?e:null),null==t?void 0:t.user){let{data:e}=await (0,l.VM)(t.user.id);c(e)}x(!1)})();let{data:{subscription:e}}=l.ND.auth.onAuthStateChange(async(e,t)=>{var s;if(o(null!=(s=null==t?void 0:t.user)?s:null),null==t?void 0:t.user){let{data:e}=await (0,l.VM)(t.user.id);c(e)}else c(null);x(!1)});return()=>e.unsubscribe()},[]);let h=async()=>{if(i){localStorage.removeItem("demo-user"),o(null),c(null),window.dispatchEvent(new CustomEvent("demo-user-updated")),setTimeout(()=>{window.location.href="/"},100);return}if(!l.ND)return;let{error:e}=await l.ND.auth.signOut();e||(o(null),c(null))},g=async()=>{if(i&&s){let e=localStorage.getItem("demo-user");if(e)try{let t=JSON.parse(e);c({id:t.id,email:t.email,public_name:t.public_name||t.email.split("@")[0],name:t.name||t.email.split("@")[0],phone:t.phone||null,city:t.city||null,state:t.state||null,whatsapp:t.whatsapp||null,bio:t.bio||null,motivation:t.motivation||null,social_link:t.social_link||null,role:t.role||"user",created_at:t.created_at||new Date().toISOString(),updated_at:t.updated_at||new Date().toISOString()})}catch(e){console.error("Error refreshing demo profile:",e)}}else if(s){let{data:e}=await (0,l.VM)(s.id);c(e)}};return(0,r.jsx)(n.Provider,{value:{user:s,userProfile:d,loading:m,signOut:h,refreshProfile:g},children:t})}function d(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2099:(e,t,s)=>{s.d(t,{ND:()=>n,QH:()=>c,VM:()=>i,eg:()=>o,lh:()=>d});var r=s(5647);let a="https://xjkaqdsldskhlhjptrga.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhqa2FxZHNsc2RraGxoanB0cmdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwMTA3MDMsImV4cCI6MjA2ODU4NjcwM30.eJuf7qNjehg1eSg7GB3Tv7xSNdz6phbWKuC8Cci0kFM",n=a&&l&&1?(0,r.UU)(a,l):null,i=async e=>{if(!n)return{data:null,error:{message:"Supabase not configured"}};let{data:t,error:s}=await n.from("users").select("*").eq("id",e).single();return{data:t,error:s}},o=async(e,t)=>(await new Promise(e=>setTimeout(e,500)),{data:{id:e,...t,updated_at:new Date().toISOString()},error:null}),d=async e=>{if(!n)return{data:null,error:{message:"Supabase not configured"}};let{data:t,error:s}=await n.from("events").insert(e).select().single();return{data:t,error:s}},c=async()=>{if(!n)return{data:{total_raised:867,total_donors:23,currency:"BRL",last_updated:new Date().toISOString()},error:null};let{data:e,error:t}=await n.from("donation_stats").select("*").single();return{data:e,error:t}}},2355:(e,t,s)=>{s.d(t,{A:()=>j});var r=s(5155),a=s(2115),l=s(6874),n=s.n(l),i=s(283),o=s(7208),d=s(9283),c=s(2227),m=s(2513),x=s(8960),u=s(8),h=s(8388),g=s(8688),f=s(3418),p=s(6678),v=s(5442);function j(){let[e,t]=(0,a.useState)(!1),[s,l]=(0,a.useState)(!1),{user:j,userProfile:N,signOut:w}=(0,i.A)(),b=(0,a.useRef)(null),y=async()=>{await w(),t(!1),l(!1)},A=()=>{var e;return(null==N?void 0:N.public_name)||(null==N?void 0:N.name)||(null==j||null==(e=j.email)?void 0:e.split("@")[0])||"Usu\xe1rio"},C=e=>e.split(" ").map(e=>{var t;return null==(t=e[0])?void 0:t.toUpperCase()}).slice(0,2).join("");return(0,a.useEffect)(()=>{function e(e){b.current&&!b.current.contains(e.target)&&l(!1)}if(s)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[s]),(0,r.jsx)("nav",{className:"bg-white shadow-md border-b-2 border-green-300 sticky top-0 z-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)(n(),{href:"/",className:"flex items-center gap-3 group",children:[(0,r.jsx)("span",{className:"text-6xl",children:"\uD83C\uDDE7\uD83C\uDDF7"}),(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-900 group-hover:text-green-600 transition-colors duration-300",children:"Marcha Brasil"})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,r.jsxs)(n(),{href:"/create-event",className:"text-gray-700 hover:text-green-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Criar"]}),(0,r.jsxs)(n(),{href:"/videos",className:"text-gray-700 hover:text-purple-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),"V\xeddeos"]}),(0,r.jsxs)(n(),{href:"/manifestacoes",className:"text-gray-700 hover:text-blue-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),"Manifesta\xe7\xf5es"]}),(0,r.jsxs)(n(),{href:"/community",className:"text-gray-700 hover:text-orange-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),"Comunidade"]}),(0,r.jsxs)(n(),{href:"/doar",className:"text-gray-700 hover:text-purple-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Apoie"]}),(0,r.jsxs)(n(),{href:"/faq",className:"text-gray-700 hover:text-gray-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"FAQ"]}),(0,r.jsxs)(n(),{href:"/como-agir",className:"text-gray-700 hover:text-green-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"A\xe7\xe3o"]}),j&&(null==N?void 0:N.role)==="admin"&&(0,r.jsxs)(n(),{href:"/admin",className:"text-gray-700 hover:text-red-600 font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5"}),"Admin"]}),j?(0,r.jsxs)("div",{className:"relative",ref:b,children:[(0,r.jsxs)("button",{onClick:()=>l(!s),className:"flex items-center space-x-3 px-3 py-2 rounded-lg border-2 border-green-200 bg-green-50 hover:bg-green-100 transition-colors",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:C(A())}),(0,r.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:A()}),(0,r.jsxs)("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Online"]})]}),(0,r.jsx)(f.A,{className:"h-4 w-4 text-gray-500"})]}),s&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:C(A())}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:A()}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:j.email}),(null==N?void 0:N.role)==="admin"&&(0,r.jsx)("span",{className:"inline-block mt-1 px-2 py-0.5 text-xs bg-red-100 text-red-800 rounded-full",children:"Admin"})]})]})}),(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)(n(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",onClick:()=>l(!1),children:[(0,r.jsx)(p.A,{className:"inline h-4 w-4 mr-2"}),"Meu Perfil"]}),(null==N?void 0:N.role)==="admin"&&(0,r.jsxs)(n(),{href:"/admin",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",onClick:()=>l(!1),children:[(0,r.jsx)(g.A,{className:"inline h-4 w-4 mr-2"}),"Painel Admin"]})]}),(0,r.jsx)("div",{className:"border-t border-gray-100 pt-2",children:(0,r.jsxs)("button",{onClick:y,className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[(0,r.jsx)(v.A,{className:"inline h-4 w-4 mr-2"}),"Sair da Conta"]})})]})]}):(0,r.jsxs)(n(),{href:"/login",className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-2 rounded-lg font-bold hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 flex items-center gap-2",children:[(0,r.jsx)(v.A,{className:"h-5 w-5"}),"Entrar / Criar Conta"]})]}),(0,r.jsx)("div",{className:"md:hidden",children:(0,r.jsx)("button",{onClick:()=>t(!e),className:"text-gray-700 hover:text-green-600 focus:outline-none",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]}),e&&(0,r.jsx)("div",{className:"md:hidden py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,r.jsxs)(n(),{href:"/create-event",className:"text-gray-700 hover:text-green-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Criar"]}),(0,r.jsxs)(n(),{href:"/videos",className:"text-gray-700 hover:text-purple-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),"V\xeddeos"]}),(0,r.jsxs)(n(),{href:"/manifestacoes",className:"text-gray-700 hover:text-blue-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),"Manifesta\xe7\xf5es"]}),(0,r.jsxs)(n(),{href:"/doar",className:"text-gray-700 hover:text-purple-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Apoie"]}),(0,r.jsxs)(n(),{href:"/faq",className:"text-gray-700 hover:text-gray-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"FAQ"]}),(0,r.jsxs)(n(),{href:"/como-agir",className:"text-gray-700 hover:text-green-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"A\xe7\xe3o"]}),j&&(null==N?void 0:N.role)==="admin"&&(0,r.jsxs)(n(),{href:"/admin",className:"text-gray-700 hover:text-red-600 font-medium py-2 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(g.A,{className:"h-5 w-5"}),"Admin"]}),j?(0,r.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 px-2 py-2 mb-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:C(A())}),(0,r.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:A()}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:j.email}),(0,r.jsxs)("div",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Online"]}),(null==N?void 0:N.role)==="admin"&&(0,r.jsx)("span",{className:"inline-block mt-1 px-2 py-0.5 text-xs bg-red-100 text-red-800 rounded-full",children:"Admin"})]})]}),(0,r.jsxs)(n(),{href:"/profile",className:"block px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors flex items-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(p.A,{className:"h-4 w-4"}),"Meu Perfil"]}),(0,r.jsxs)("button",{onClick:y,className:"block w-full text-left px-2 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-2",children:[(0,r.jsx)(v.A,{className:"h-4 w-4"}),"Sair da Conta"]})]}):(0,r.jsxs)(n(),{href:"/login",className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-3 rounded-lg font-bold text-center mt-2 flex items-center justify-center gap-2",onClick:()=>t(!1),children:[(0,r.jsx)(v.A,{className:"h-5 w-5"}),"Entrar / Criar Conta"]})]})})]})})}}}]);